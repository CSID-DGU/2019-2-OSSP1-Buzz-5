{"ast":null,"code":"var _jsxFileName = \"/Users/seojin-won/wisdom-x-wisdom/client/src/containers/ChatContainer.js\";\nimport React, { Component } from 'react';\nimport \"../components/css/Room.scss\";\nexport class ChatContainer extends Component {\n  constructor(props) {\n    super(props);\n\n    this.componentDidMount = () => {\n      this.props.socket.on('chat', obj => {\n        const log = this.state.messages;\n        obj.key = 'key_' + (this.state.messages.length + 1);\n        log.push(obj);\n        this.setState({\n          messages: log\n        });\n      });\n      this.scrollToBottom();\n    };\n\n    this.componentDidUpdate = () => {\n      this.scrollToBottom();\n    };\n\n    this.handleChange = e => {\n      e.preventDefault();\n      const msg = e.target.value;\n      this.setState({\n        message: msg\n      });\n    };\n\n    this.handleSubmit = e => {\n      if (this.state.message == \"\") {\n        return;\n      }\n\n      this.props.socket.emit('chat', {\n        name: this.props.name,\n        msg: this.state.message,\n        timestamp: this.getTimeStamp()\n      });\n      this.setState({\n        message: \"\"\n      });\n    };\n\n    this.getTimeStamp = () => {\n      var date = new Date();\n      var formatedDate = // this.changeFormat(date.getFullYear(), 4) + '-' +\n      // this.changeFormat(date.getMonth() + 1, 2) + '-' +\n      // this.changeFormat(date.getDate(), 2) + ' ' +\n      this.changeFormat(date.getHours(), 2) + ':' + this.changeFormat(date.getMinutes(), 2) + ':' + this.changeFormat(date.getSeconds(), 2);\n      return formatedDate;\n    };\n\n    this.changeFormat = (n, digits) => {\n      var zero = '';\n      var i;\n      n = n.toString();\n\n      if (n.length < digits) {\n        for (i = 0; i < digits - n.length; i++) zero += '0';\n      }\n\n      return zero + n;\n    };\n\n    this.handleKeyPress = event => {\n      const msg = this.state.message;\n\n      if (msg != \"\" && event.key == 'Enter') {\n        this.handleSubmit();\n      }\n    };\n\n    this.scrollToBottom = () => {\n      const chat = document.getElementById(\"chatLog\");\n      chat.scrollTop = chat.scrollHeight;\n    };\n\n    this.state = {\n      message: \"\",\n      messages: []\n    };\n  }\n\n  render() {\n    // var messages;\n    // if(this.props.name == window.sessionStorage.getItem('name')) {\n    //    messages = this.state.messages.map(e => (\n    //     <div key={e.key} className=\"d-flex flex-row-reverse chat_spacer\">\n    //       <span className=\"badge badge-pill badge-primary chat_name\">{e.name}</span>\n    //       <span className=\"chat_message\">{e.msg}</span>\n    //       <span className=\"chat_timestamp\">{e.timestamp}</span>\n    //     </div>\n    //   ))\n    // } else {\n    //   messages = this.state.messages.map(e => (\n    //     <div key={e.key} className=\"d-flex flex-row chat_spacer\">\n    //       <span className=\"badge badge-pill badge-primary\">{e.name}</span>\n    //       <span className=\"chat_message\">{e.msg}</span>\n    //       <span className=\"chat_timestamp\">{e.timestamp}</span>\n    //     </div>\n    //   ))\n    // }\n    // const messages = this.renderChat()\n    var messages = this.state.messages.map(e => React.createElement(\"div\", {\n      key: e.key,\n      className: \"d-flex flex-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      className: \"badge badge-pill badge-primary chat_name\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 112\n      },\n      __self: this\n    }, e.name), React.createElement(\"span\", {\n      className: \"chat_message\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 113\n      },\n      __self: this\n    }, e.msg), React.createElement(\"span\", {\n      className: \"chat_timestamp\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 114\n      },\n      __self: this\n    }, e.timestamp)));\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"col\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"row-xl-10\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"chatLog\",\n      id: \"chatLog\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, messages)), React.createElement(\"hr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"row-xl-2\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      className: \"form-control\",\n      placeholder: \"Message...\",\n      name: \"chat\",\n      type: \"message\",\n      value: this.state.message,\n      onChange: this.handleChange,\n      onKeyPress: this.handleKeyPress,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      className: \"input-group-btn\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: \"btn btn-default\",\n      type: \"submit\",\n      onClick: this.handleSubmit,\n      onSubmit: this.handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      className: \"fa fa-send-o\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141\n      },\n      __self: this\n    })))))));\n  }\n\n}\nexport default ChatContainer;","map":{"version":3,"sources":["/Users/seojin-won/wisdom-x-wisdom/client/src/containers/ChatContainer.js"],"names":["React","Component","ChatContainer","constructor","props","componentDidMount","socket","on","obj","log","state","messages","key","length","push","setState","scrollToBottom","componentDidUpdate","handleChange","e","preventDefault","msg","target","value","message","handleSubmit","emit","name","timestamp","getTimeStamp","date","Date","formatedDate","changeFormat","getHours","getMinutes","getSeconds","n","digits","zero","i","toString","handleKeyPress","event","chat","document","getElementById","scrollTop","scrollHeight","render","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport \"../components/css/Room.scss\"\n\nexport class ChatContainer extends Component {\n  constructor(props) {\n    super(props)\n\n    this.state = {\n      message: \"\",\n      messages: [],\n    }\n  }\n\n  componentDidMount = () => {\n    this.props.socket.on('chat',  (obj) => {\n      const log = this.state.messages\n      obj.key = 'key_' + (this.state.messages.length + 1)\n      log.push(obj)\n      this.setState({messages: log})\n    })\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate = () => {\n    this.scrollToBottom();\n  }\n\n  handleChange = e => {\n    e.preventDefault();\n    const msg = e.target.value;\n    this.setState({\n      message: msg,\n    })\n  }\n\n  handleSubmit = e => {\n    if(this.state.message == \"\") {\n      return\n    }\n\n    this.props.socket.emit('chat', {\n      name: this.props.name, \n      msg: this.state.message,\n      timestamp: this.getTimeStamp()\n    });\n\n    this.setState({\n      message: \"\"\n    })\n  }\n\n  getTimeStamp = () => {\n    var date = new Date()\n    var formatedDate = \n      // this.changeFormat(date.getFullYear(), 4) + '-' +\n      // this.changeFormat(date.getMonth() + 1, 2) + '-' +\n      // this.changeFormat(date.getDate(), 2) + ' ' +\n  \n      this.changeFormat(date.getHours(), 2) + ':' +\n      this.changeFormat(date.getMinutes(), 2) + ':' +\n      this.changeFormat(date.getSeconds(), 2);\n  \n    return formatedDate;\n  }\n\n   changeFormat = (n, digits) => {\n    var zero = '';\n    var i;\n    n = n.toString();\n\n    if (n.length < digits) {\n      for (i=0; i<digits-n.length; i++)\n        zero += '0';\n    }\n    return zero + n;\n  }\n\n  handleKeyPress = event => {\n    const msg = this.state.message;\n    if(msg != \"\" && event.key == 'Enter') {\n      this.handleSubmit()\n    }\n  }\n\n  scrollToBottom = () => {\n    const chat = document.getElementById(\"chatLog\");\n    chat.scrollTop = chat.scrollHeight;\n  }\n\n  render() {\n    // var messages;\n    // if(this.props.name == window.sessionStorage.getItem('name')) {\n    //    messages = this.state.messages.map(e => (\n    //     <div key={e.key} className=\"d-flex flex-row-reverse chat_spacer\">\n    //       <span className=\"badge badge-pill badge-primary chat_name\">{e.name}</span>\n    //       <span className=\"chat_message\">{e.msg}</span>\n    //       <span className=\"chat_timestamp\">{e.timestamp}</span>\n    //     </div>\n    //   ))\n    // } else {\n    //   messages = this.state.messages.map(e => (\n    //     <div key={e.key} className=\"d-flex flex-row chat_spacer\">\n    //       <span className=\"badge badge-pill badge-primary\">{e.name}</span>\n    //       <span className=\"chat_message\">{e.msg}</span>\n    //       <span className=\"chat_timestamp\">{e.timestamp}</span>\n    //     </div>\n    //   ))\n    // }\n    // const messages = this.renderChat()\n    var messages = this.state.messages.map(e => (\n      <div key={e.key} className=\"d-flex flex-row\">\n        <span className=\"badge badge-pill badge-primary chat_name\">{e.name}</span>\n        <span className=\"chat_message\">{e.msg}</span>\n        <span className=\"chat_timestamp\">{e.timestamp}</span>\n      </div>\n    ))\n\n    return (\n      <div>\n        <div className=\"col\">\n          <div className=\"row-xl-10\">\n            <div className=\"chatLog\" id=\"chatLog\">\n              {messages}\n            </div>\n          </div>\n          <hr/>\n          <div className=\"row-xl-2\">\n            <div className=\"input-group\">\n              <input className=\"form-control\" \n                    placeholder=\"Message...\" \n                    name=\"chat\"\n                    type=\"message\" \n                    value={this.state.message} \n                    onChange={this.handleChange}\n                    onKeyPress={this.handleKeyPress} />\n              <div className=\"input-group-btn\">\n                <button className=\"btn btn-default\" \n                        type=\"submit\"\n                        onClick={this.handleSubmit} \n                        onSubmit={this.handleSubmit}>\n                  <i className=\"fa fa-send-o\"/>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport default ChatContainer\n"]},"metadata":{},"sourceType":"module"}